# Log_analistics.py
## Log_analistics.pyについて
サーバー監査ログを解析し、監視サーバーの状態ログを出力するプログラム（サーバーの数は設定不要）<br>
状態として＜タイムアウト＞＜サーバー復帰＞＜スイッチ障害＞＜スイッチ復帰＞＜過負荷＞＜過負荷解消＞を出力<br>
あるサブネット内のサーバが全て故障（ping応答がすべてタイムアウト）している場合は、その（サブネットの）スイッチの故障とみなす<br>
-------------------------------------------------------------------------------------------------------------------------------<br>
＜状態(障害発生or解消)＞,＜アドレス(サーバーorスイッチ)＞,＜障害発生時刻＞,＜障害発生期間＞<br>
-------------------------------------------------------------------------------------------------------------------------------<br>
確認日時は、YYYYMMDDhhmmssの形式。ただし、年＝YYYY（4桁の数字）、月＝MM（2桁の数字。以下同様）、日＝DD、時＝hh、分＝mm、秒＝ssである。
サーバアドレスは、ネットワークプレフィックス長付きのIPv4アドレスである。障害が解消されなかった場合、最後に出力される。
障害発生期間は、dd:mm:ss表記(day出力もされる)<br>

以下に出力の例(抜粋)<br>
++++++++++++++++++++++++++++++++++++++++++++++++<br>
サーバー復帰　192.168.1.1/24　: 20201019133134~0:03:00<br>
スイッチ復帰　192.168.1       : 20201019133135~0:02:59<br>
サーバー復帰　192.168.1.2/24　: 20201019133135~0:03:00<br>
サーバー復帰　10.20.30.1/16 　: 20201019133124~0:04:00<br>
スイッチ復帰　10.20.30        : 20201019133125~0:03:59<br>
過負荷解消　　10.20.30.1/16   : 20201019095724~0:01:00<br>
　過負荷　　　192.168.1.2/24  : 20201020235935~<br>
スイッチ障害　192.168.1       : 20201019133135~<br>
++++++++++++++++++++++++++++++++++++++++++++++++<br>

#### ユーザーによる変数変更は変数N,t,m(プログラムに直書き)<br>
N : 連続してN回タイムアウトした場合にのみ故障とみなす<br>
m,t : 直近m回の平均応答時間がtミリ秒を超えた場合は、サーバが過負荷状態になっているとみなす<br>
#### 監査ファイルと同じディレクトリで実行し第一引数に監査ファイルをに入力する必要があります
標準ライブラリのみで実行可能

## 監査ファイルについて
---------------------------------------------------------------<br>
＜確認日時＞,＜サーバアドレス＞,＜応答結果＞<br>
---------------------------------------------------------------<br>
確認日時は、YYYYMMDDhhmmssの形式。ただし、年＝YYYY（4桁の数字）、月＝MM（2桁の数字。以下同様）、日＝DD、時＝hh、分＝mm、秒＝ssである。
サーバアドレスは、ネットワークプレフィックス長付きのIPv4アドレスである。
応答結果には、pingの応答時間がミリ秒単位で記載される。ただし、タイムアウトした場合は"-"(ハイフン記号)となる。<br>

以下に監視ログの例(抜粋)<br>
++++++++++++++++++++++++++<br>
20201019133124,10.20.30.1/16,2<br>
20201019133125,10.20.30.2/16,1<br>
20201019133134,192.168.1.1/24,10<br>
20201019133135,192.168.1.2/24,5<br>
20201019133224,10.20.30.1/16,522<br>
20201019133225,10.20.30.2/16,1<br>
20201019133234,192.168.1.1/24,8<br>
20201019133235,192.168.1.2/24,15<br>
20201019133324,10.20.30.1/16,-<br>
20201019133325,10.20.30.2/16,2<br>
++++++++++++++++++++++++++<br>

## プログラムの簡単な処理の流れ
ファイルを読み込み、list(list_log)化<br>
スイッチ障害判断を行うため全ての監査サーバーをネットワーク部ごとにlist(list_ipadress_server)化<br>
過負荷確認のためそれぞれのサーバーの最新ping(m個)を最大要素数mのlist(list_ping_average)化<br>
mainでは、それぞれの状態ごとに問題の通り出力する<br>
最後まで復帰していないものや過負荷なものを出力する<br>

## 開発環境
windows10<br>
Python 3.9.1<br>

## ファイル構造
プログラムはlog_analytics.pyのみ<br>
test_dataはテストデータ４つ(sample1,2.txt・test1,2.txt)<br>
output.txtは出力結果は（コンソールから張り付けたもの）<br>
